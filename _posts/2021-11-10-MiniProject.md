---
title: 미니 프로젝트01 우리동네 대피소
tags: [Project]
categories: MINIPROJECT
---
# 미니 프로젝트 시작 (약 12시간(1일 4시간))
드디어 미니 프로젝트를 시작하게 되었습니다. 
번갯불에 콩구워먹듯이, 자바 슝슝 스프링 슝슝 이렇게 진도를 나가고 있고, 
이제 spring 막 시작해서 프론트 단은 하나도 진짜 하나도 모르는데, 웹으로 뭔가를 만들어보래서 구글님의 도움을 받아 하고 있슴다! 

# 프로젝트:  우리동네 대피소 
지금 까지 배운 것을 점검하고, 감을 익히기 위해서 하는 첫번째 프로젝트여서 가볍게 해도 된다고 했지만, 그 어떤것도 가볍지가 않습니다 ㅠㅠ.. 

제가 선정한 프로젝트는 "우리동네 대피소" 입니다. 천재지변, 호환마마 ~~보다 무서운 비디오~~를 피하기 위한 재난 대피소의 위치정보를 보여주고, 입실, 퇴실을 선택하게 해서 현재 대피소의 상황을 살펴볼 수 있게 하는 것입니다. 

약 200여개의 데이터가 있고, 이 데이터를 오라클 데이터베이스에 넣어서 접속하는 형태로 구성하였습니다. 

## 구현 내용 
- 전체 목록을 보여줍니다. (완료)
- 목록을 선택 하여 상세 보기를 할 수 있도록 합니다. (완료)
    - 해당 대피처 페이지를 들어가면 위치 정보를 확인하기 위한 지도를 보여줍니다. (완료)
    - 입실을 선택 하면 해당 대피소의 인원이 1 증가 합니다. (완료)
    - 퇴실을 선택 하면 해당 대피소의 인원이 1 감소 합니다. (완료)
- 목록에 대피소를 등록 합니다. (완료)
- 장소와 지역으로 검색 하도록 합니다. (완료)
    - 입력한 단어를 포함하는 모든 장소가 나옵니다. 

### 진행 정도
- 월요일부터 시작해서 ~~약 3일 정도 됬는데 현재 검색 기능 빼고는~~ 모두 구현 하였습니다. 
- 검색이 사실 제일 쉬울지 알았는데 제일 늦어졌습니다...
## 개발 환경 
- M1 mac BigSur 11.6
- IntelliJ ultimate
- maven 
- Spring 4.3.18.RELEASE
- Java 1.8
- tomcat 9.0.54
- Oracle cloud ATP database 
## 언어 
- java
- javascript 
- html
- css
## 프로젝트 구성 

![클래스 다이어그램](https://github.com/pineplanet/pineplanet.github.io/blob/main/assets/images/10.png?raw=true)


## 지금까지 구현한 것들 

현재 대문 화면은 이래요.... ㅋㅋㅋ html이랑 css는 배운적이 없어서 .... 진짜 최선을 다한거에요.
구글 포맷을 빌려왔어요. 위에 ㅇㅇㄷㅍㅅ 에 링크를 걸어서 이것을 클릭하면 전체 목록이 나오고, 검색어를 입력한다음 엔터를 누르면 검색된 단어를 포함하는 대피소를 보여주는 목록이 나옵니다. 부분 검색이 가능하도록 만들어서 목록으로 나오게 하였습니다. 
.......
![재난 대피소 인덱스](https://github.com/pineplanet/pineplanet.github.io/blob/main/assets/images/8.png?raw=true)


![재난 대피소 목록](https://github.com/pineplanet/pineplanet.github.io/blob/main/assets/images/9.png?raw=true)

재난 대피소를 만들 때 사실 로그인을 하게 하고, 관리자만 등록을 할 수 있게 하고, 일반 사용자들은 자신의 계정에 입실한 대피소 정보와 목록, 상세페이지만 볼 수 있게 하려고 했는데, 지금은 우선 로그인 기능을 뺐어요. 

![재난 대피소 새로 등록 버튼](https://github.com/pineplanet/pineplanet.github.io/blob/main/assets/images/6.png?raw=true)

위의 버튼을 누르면, 다음과 같은 화면이 나와요. 

![재난 대피소 새로 등록 화면](https://github.com/pineplanet/pineplanet.github.io/blob/main/assets/images/7.png?raw=true)

그리고 목록에서 주소를 클릭하면, 다음과 같은 상세 페이지가 나옵니다. 지도는 카카오 API를 사용하였고, Jsp에서 script로 주소를 좌표로 변환해서 찍어주게 했어요. 


![재난 대피소 상세페이지1](https://github.com/pineplanet/pineplanet.github.io/blob/main/assets/images/3.png?raw=true)

그리고 아래에 있는 입실 버튼을 누르면 현재 인원 수가 올라가고, 

![재난 대피소 상세페이지2](https://github.com/pineplanet/pineplanet.github.io/blob/main/assets/images/4.png?raw=true)

퇴실 버튼을 누르면 현재 인원 수가 내려갑니다. 

![재난 대피소 상세페이지3](https://github.com/pineplanet/pineplanet.github.io/blob/main/assets/images/5.png?raw=true)



## 프로젝트를 진행 하면서 
콘솔창으로 프린트만 해보다가 웹으로 데이터를 넘겨주고 넘겨 받는일이 어떻게 진행 되는 것인지 조금이나마 배울 수 있었고, 제가 매일 아무생각 없이 쓰는 모든 서비스들은 사실 누군가의 피땀눈물이구나 하는 생각도 들었습니다. 

M1맥을 쓰고 있어서 뭔가 해결해야할 일들이 많지만, 그래도 하나하나 해결할때 느껴지는 희열감과 조금씩 완성 되가면서 쌓이는 것들이 있어서 스트레스 받지만 재밌다는 생각을 했습니다. 

그리고 다 준비된 상황에서 하나 하나 떠먹여주는 것을 받아먹는 것이 아니라, 구글링 해보기도 하고 다른 사람들이 한 것들을 눈치껏 하나씩 해보면서 찾는 과정에서 생각보다 많이 배울 수 있었어요. 

당장 어제만 해도 콘트롤러가 뭐야 ㅠ 했었는데, 살짝 아주 조금은 알겠다는 생각도 듭니다. 

아직 완성 한 것이 아니라 한참 더 남았지만, 그래도 진짜 혼자서 많이 배웠다는 생각이 들어서 뿌듯하기도 하고, 진짜 많이 채워야겠구나 하는 생각도 들었습니다. 

### 배운 것 
#### Controller의 역할 
- controller 는 모든 기능을 통제하는 역할을 합니다. 사용자가 어떤 요청을 했을 때 내부에서 모델과 뷰를 연결 해서 데이터가 넘어갈 수 있게 이어 붙이는 역할을 합니다. 그러니까 어떤 기능을 호출 했을 때, 내부에서 모델을 호출 하고 리턴 받은 값을 적절한 view에 연결해서 사용자가 해당 view에 접근할 수 있게 합니다. 
- 제가 미니 프로젝트를 하면서 배운 것은 컨트롤러에 @RequestMapping으로 맵핑된 값을 사용자 브라우저에서 요청하면 어!! 이걸 불렀어!!!! 하면서 그아래 할당(?)된 메소드가 동작하기 시작해요. 그리고 service(vo!! DAO!!)를 호출 해서 데이터를 처리하게 하고, service로 부터 리턴 받은 값을 model객체에 넣어서 view로 보내줍니다. 그러면 사용자는 (주소)/mappingvalue를 호출했는데 -> /controller가 지정한 view가 나오넹? 이렇게 됩니다. 
- 그래서 view 안에서 다른 페이지로 이동할 때도 controller와 연결 해서 data를 처리하고 view 로 넘어 간다는것을 배웠습니다. 
    - /list.cu를 대피소 목록을 보여주는 페이지(list.jsp)로 해두었는데, localhost:9000/list.cu를 입력하면 컨트롤러가 잡아채서 service.getList()를 호출 하고 리턴 받은 List 를 list.jsp로 보내주면서 브라우저가 list.jsp를 받게 합니다. 그러면 목록이 쭉 나와요. 
    - list.jsp에서는 대피소의 상세 페이지로 넘어갈 수 있도록 주소 부분에 링크를 걸게 했는데, 여기서 다시 controller에 지정된 메소드로 넘어가게 했습니다. 그리고 처리한 데이터를 다시 모델 객체에 담아서 상세 페이지를 보여주는 jsp로 넘깁니다. 
    - 어렴풋하게만 느껴졌던 콘트롤러의 역할과 데이터의 이동에 대해 좀 더 확실하게 배울 수 있었습니다. 
#### 카카오 맵 api 
- 카카오 map api 사용하기 
    - api를 사용할 수 있도록 사용자 등록이 필요합니다.
        - https://developers.kakao.com/
        - api를 발급받고, 접근허용되는 주소를 입력 해야합니다.저는 톰캣으로 접근할 것이기 때문에 localhost:9000, localhost:8080으로 넣었어요. 
        - 저는 jsp 로 작성해서 javascript로 접근 할 것 이기 때문에 javascript 키를 사용했습니다. 
        - mdel 객체의 정보를 script로 넣어주기 
            - model 객체에서 전달 받은 주소를 script 안으로 넣어서 주소 -> 좌표로 바꿔서 위치를 정하고, 마커 위에 올라가는 이름도 해당 장소로 넣어주기 위해서 script 안에 넣어줄 필요가 있었습니다. 처음에는 ${}로 넣었는데 오류가 났어요. 
            - script에서 model 객체를 사용하기 위해선 "${}" 이렇게 따옴표를 넣어서 사용해야한다는 것을 배웠습니다. 
            - 사실 별거 아닌데 처음이라서 어려웠습니다 ㅋㅋㅋ....
#### 검색 기능과 컨트롤러 
- 검색 기능도 사실 작동하게 하고나면 정말 별거 아닌데, 개념과 코드 작성이 처음엔 어려웠어요. 
- html의 액션 기능을 이용해서 입력한 값을 보낼 주소(/list.search)를 잡고, 거기에 검색창에서 입력 받은 장소 또는 주소의 부분문자열과 함께 던지도록 했습니다. 
- /list.search 는 전달 받은 장소 문자열을 새로운 vo에 담아서 대피소를 찾는 service로 던지고,vo 리스트를 리턴 받아서 다시 모든 대피소가 리스트로 출력됬었던 jsp로 던지게 합니다. 사용자의 브라우저에는 그 jsp가 보여지고요. 

- 아 이런식으로 컨트롤러가 작동하고 보낼 수 있구나 하는걸 배웠습니다. 

#### HTML과 CSS 심오한 세계 경험 
- 이게 사실 제일 어려웠어요. 어떻게 해서 손을 대야 할지 몰라서, 구글링 해보면서 하나하나 바꿔갔어요..

#### github 연동
- 모든 소스를 공유 하기 위해서 github 레포지토리를 만들어서 올렸습니다. 그런데 그과정에서 오라클 클라우드 전자지갑 정보와 비밀번호가 같이 올라가졌었어요. 
- 이걸 다시 지우고 올리기 위한 과정에서 삽질을 하면서 또 뭔가를 배우게 됬습니다.
- 배운 것 
    - 먼저 온라인에서만 레포지토리를 삭제 해도 내 저장소는 아직 살아있다는 것 을 배웠어요. 삭제 해도 업로드 했던 정보가 살아남아있어요. 
    - 작업 되돌리기 
        - 위와 같은 상황에서 git으로 커밋한 걸 다시 되돌리니까 프로젝트가 날아갔었어요. 
        - 날아간 내용을 다시 되살리려면 git reflog 로 임시 저장된(?) 것들을 확인하고,
        -  그중에서 맞는 head를 선택 해서 git reset --hard HEAD@{5} 를 수행 해줘야합니다. 
    - 원격 저장소에 올린 파일 삭제 하기 
        - 다시 레포지토리를 만들고 올리기 전에 .ignore 에 원하는 파일들을 올리면 커밋, 푸쉬 되지 않게 막을 수 있는데, 저는 ignore를 선택 해서 등록할 수 가 없었어요. 그래서 일단 올리고 삭제 하기로 했습니다. 
        - 우선 원격 저장소에 있는 것만 삭제 하려면 터미널에서 아래와 같이 입력 합니다.
            - git rm --cached [파일명]
            - 만약 디렉토리 라면 여기에 -r 을 넣어줍니다. 
            - 그리고 커밋을 해줍니다. git commmit -m "delete unnecessary files" 
            - 그 다음 git push origin master 를 해주면 일단 완료 됩니다. 
            - 그리고 인텔리제이에 가서 해당 파일들을 .ignore에 추가 해줍니다. 그러면 앞으로는 안올라갑니다. 
        